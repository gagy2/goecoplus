<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Shop Revo - Comparateur et Suivi Prix Amazon</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body { font-family: Arial, sans-serif; max-width: 1200px; margin: 0 auto; padding: 20px; }
        .product { border: 1px solid #ddd; margin: 10px 0; padding: 15px; border-radius: 8px; }
        .product img { max-width: 200px; }
        .price-chart { height: 300px; margin: 20px 0; }
        .watchlist { background: #f9f9f9; padding: 20px; border-radius: 8px; }
        button { background: #ff9900; color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer; }
        button:hover { background: #e68900; }
        iframe { width: 120px; height: 240px; border: none; }
    </style>
</head>
<body>
    <h1>Shop Revo : Meilleurs Deals Amazon & Suivi Prix</h1>
    <p>Comparez des articles, suivez les prix dans le temps et achetez directement. Inspiré de Keepa et CamelCamelCamel.</p>

    <!-- Section Articles (exemples, ajoutez vos ASINs Amazon.ca) -->
    <section>
        <h2>Articles Recommandés</h2>
        <div id="products">
            <!-- Produit exemple 1 -->
            <div class="product" data-asin="B08N5WRWNQ">
                <img src="https://m.media-amazon.com/images/I/61ABC123.jpg" alt="Produit 1">
                <h3>Ex: Écouteurs Wireless</h3>
                <p>Prix actuel: <strong>49.99 CAD</strong></p>
                <iframe src="https://rcm-eu.amazon-adsystem.com/e/cm?lt1=_blank&bc1=000000&IS2=1&bg1=FFFFFF&fc1=000000&lc1=0000FF&t=VOTRE_TAG_CA&language=fr_CA&o=15&p=8&l=as4&m=amazon&f=ifr&ref=as_ss_li_til&asins=B08N5WRWNQ&linkId=example"></iframe>
                <br><button onclick="addToWatch('Écouteurs Wireless', 'B08N5WRWNQ', 49.99)">Suivre le prix</button>
            </div>
            <!-- Ajoutez d'autres produits ici avec ASIN réels Amazon.ca -->
        </div>
    </section>

    <!-- Liste de Suivi -->
    <section class="watchlist">
        <h2>Ma Liste de Suivi</h2>
        <div id="watchlist"></div>
    </section>

    <script>
        // Données mockées pour historique prix (remplacez par fetch API Keepa)
        const mockPriceHistory = {
            'B08N5WRWNQ': [
                { date: '2026-01-01', price: 59.99 },
                { date: '2026-02-01', price: 49.99 },
                { date: '2026-02-07', price: 45.00 }
            ]
        };

        function addToWatch(name, asin, currentPrice) {
            let watchlist = JSON.parse(localStorage.getItem('watchlist')) || [];
            if (!watchlist.find(item => item.asin === asin)) {
                watchlist.push({ name, asin, currentPrice, history: mockPriceHistory[asin] || [] });
                localStorage.setItem('watchlist', JSON.stringify(watchlist));
                renderWatchlist();
                alert(`${name} ajouté à la liste de suivi !`);
            }
        }

        function renderWatchlist() {
            const watchlist = JSON.parse(localStorage.getItem('watchlist')) || [];
            const container = document.getElementById('watchlist');
            container.innerHTML = watchlist.map((item, index) => `
                <div class="product">
                    <h4>${item.name} (${item.currentPrice} CAD)</h4>
                    <canvas id="chart${index}" class="price-chart"></canvas>
                    <button onclick="removeFromWatch(${index})">Retirer</button>
                </div>
            `).join('');

            watchlist.forEach((item, index) => {
                const ctx = document.getElementById(`chart${index}`).getContext('2d');
                new Chart(ctx, {
                    type: 'line',
                     {
                        labels: item.history.map(h => h.date),
                        datasets: [{ label: 'Prix',  item.history.map(h => h.price), borderColor: '#ff9900' }]
                    },
                    options: { scales: { y: { beginAtZero: false } } }
                });
            });
        }

        function removeFromWatch(index) {
            let watchlist = JSON.parse(localStorage.getItem('watchlist')) || [];
            watchlist.splice(index, 1);
            localStorage.setItem('watchlist', JSON.stringify(watchlis
